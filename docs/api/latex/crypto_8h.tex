\doxysection{include/e2ees/crypto.h File Reference}
\hypertarget{crypto_8h}{}\label{crypto_8h}\index{include/e2ees/crypto.h@{include/e2ees/crypto.h}}
{\ttfamily \#include $<$stdint.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$stdbool.\+h$>$}\newline
{\ttfamily \#include "{}e2ees/e2ees.\+h"{}}\newline
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{crypto_8h_ab1bd3ef9b594e851769e8d7baf17f0f1}{SHA256\+\_\+\+OUTPUT\+\_\+\+LENGTH}}~32
\item 
\#define \mbox{\hyperlink{crypto_8h_af267d8aed138e3cdf5cc4b635ab6fd12}{CURVE25519\+\_\+\+KEY\+\_\+\+LENGTH}}~32
\item 
\#define \mbox{\hyperlink{crypto_8h_a5a2bb125ad5cf2351de9cb070d78bcc6}{CURVE\+\_\+\+SIGNATURE\+\_\+\+LENGTH}}~64
\item 
\#define \mbox{\hyperlink{crypto_8h_af36200aa1d4d85292b027b6d811263ad}{AES256\+\_\+\+KEY\+\_\+\+LENGTH}}~32
\item 
\#define \mbox{\hyperlink{crypto_8h_a1395a9ebbdaeedb00807f52f8cf9381a}{AES256\+\_\+\+IV\+\_\+\+LENGTH}}~16
\item 
\#define \mbox{\hyperlink{crypto_8h_a8c63fc2cbdf1811a42513c959ca5b15a}{AES256\+\_\+\+GCM\+\_\+\+TAG\+\_\+\+LENGTH}}~16
\item 
\#define \mbox{\hyperlink{crypto_8h_adbbbf1c1be8a7fb625cf3879c3168dc3}{AES256\+\_\+\+DATA\+\_\+\+IV\+\_\+\+LENGTH}}~12
\item 
\#define \mbox{\hyperlink{crypto_8h_a8a2b042788dd7df27281676080f9d6cc}{CURVE25519\+\_\+\+RANDOM\+\_\+\+LENGTH}}~\mbox{\hyperlink{cipher__ecc_8h_af267d8aed138e3cdf5cc4b635ab6fd12}{CURVE25519\+\_\+\+KEY\+\_\+\+LENGTH}}
\item 
\Hypertarget{crypto_8h_acb48f175c6bc95c40cac93a2805e8fbb}\label{crypto_8h_acb48f175c6bc95c40cac93a2805e8fbb} 
\#define {\bfseries AES256\+\_\+\+FILE\+\_\+\+AD}~"{}E2\+EES -\/-\/-\/$>$ file encryption with AES256/GCM/Nopadding algorithm"{}
\item 
\Hypertarget{crypto_8h_a4708956a26b6c3a0df7073e1b45ca8b2}\label{crypto_8h_a4708956a26b6c3a0df7073e1b45ca8b2} 
\#define {\bfseries AES256\+\_\+\+FILE\+\_\+\+AD\+\_\+\+LEN}~64
\item 
\Hypertarget{crypto_8h_a3c455cd930c0d97635fe21e48e14ba24}\label{crypto_8h_a3c455cd930c0d97635fe21e48e14ba24} 
\#define {\bfseries AES256\+\_\+\+FILE\+\_\+\+KDF\+\_\+\+INFO}~"{}FILE"{}
\item 
\Hypertarget{crypto_8h_a544bceee02b8927df6ee6905000c44f6}\label{crypto_8h_a544bceee02b8927df6ee6905000c44f6} 
\#define {\bfseries AES256\+\_\+\+DATA\+\_\+\+AD}~"{}E2\+EES -\/-\/-\/$>$ data encryption with AES256/GCM/Nopadding algorithm"{}
\item 
\Hypertarget{crypto_8h_a1b3f2736657deae3801214287adbc704}\label{crypto_8h_a1b3f2736657deae3801214287adbc704} 
\#define {\bfseries AES256\+\_\+\+DATA\+\_\+\+AD\+\_\+\+LEN}~64
\item 
\#define \mbox{\hyperlink{crypto_8h_a06a923f056ee99cb8562286c8fcffc82}{FILE\+\_\+\+ENCRYPTION\+\_\+\+BUFFER\+\_\+\+LENGTH}}~8192
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{crypto_8h_ac56ee8caaea1c4a8f22133d577fa083c}\label{crypto_8h_ac56ee8caaea1c4a8f22133d577fa083c} 
int {\bfseries CURVE25519\+\_\+crypto\+\_\+sign\+\_\+keypair} (Protobuf\+CBinary\+Data \texorpdfstring{$\ast$}{*}pub\+\_\+key, Protobuf\+CBinary\+Data \texorpdfstring{$\ast$}{*}priv\+\_\+key)
\item 
\Hypertarget{crypto_8h_a65624437d7f4f49cf630954dda2e4ef5}\label{crypto_8h_a65624437d7f4f49cf630954dda2e4ef5} 
int {\bfseries CURVE25519\+\_\+crypto\+\_\+keypair} (Protobuf\+CBinary\+Data \texorpdfstring{$\ast$}{*}pub\+\_\+key, Protobuf\+CBinary\+Data \texorpdfstring{$\ast$}{*}priv\+\_\+key)
\item 
\Hypertarget{crypto_8h_a3ebc35d7b4bb05bb929166e6091664f6}\label{crypto_8h_a3ebc35d7b4bb05bb929166e6091664f6} 
int {\bfseries CURVE25519\+\_\+crypto\+\_\+sign\+\_\+signature} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}signature\+\_\+out, size\+\_\+t \texorpdfstring{$\ast$}{*}signature\+\_\+out\+\_\+len, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}msg, size\+\_\+t msg\+\_\+len, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}private\+\_\+key)
\item 
\Hypertarget{crypto_8h_a734a089f76a3dff47de01d2d79eee9b7}\label{crypto_8h_a734a089f76a3dff47de01d2d79eee9b7} 
int {\bfseries CURVE25519\+\_\+crypto\+\_\+sign\+\_\+verify} (const uint8\+\_\+t \texorpdfstring{$\ast$}{*}signature\+\_\+in, size\+\_\+t signature\+\_\+in\+\_\+len, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}msg, size\+\_\+t msg\+\_\+len, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}public\+\_\+key)
\item 
\Hypertarget{crypto_8h_aa3de60a04782f3247947a01adada18cc}\label{crypto_8h_aa3de60a04782f3247947a01adada18cc} 
int {\bfseries crypto\+\_\+curve25519\+\_\+dh} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}shared\+\_\+secret, const Protobuf\+CBinary\+Data \texorpdfstring{$\ast$}{*}our\+\_\+key, const Protobuf\+CBinary\+Data \texorpdfstring{$\ast$}{*}ciphertext)
\item 
\Hypertarget{crypto_8h_a5f6aa8d05151aa0879b7be7ddd1f52c0}\label{crypto_8h_a5f6aa8d05151aa0879b7be7ddd1f52c0} 
void {\bfseries crypto\+\_\+curve25519\+\_\+sign} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}private\+\_\+key, uint8\+\_\+t \texorpdfstring{$\ast$}{*}msg, size\+\_\+t msg\+\_\+len, uint8\+\_\+t \texorpdfstring{$\ast$}{*}signature\+\_\+out)
\item 
\Hypertarget{crypto_8h_a91c2ee82b8037a91d1df32c106387633}\label{crypto_8h_a91c2ee82b8037a91d1df32c106387633} 
int {\bfseries crypto\+\_\+curve25519\+\_\+verify} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}signature\+\_\+in, uint8\+\_\+t \texorpdfstring{$\ast$}{*}public\+\_\+key, uint8\+\_\+t \texorpdfstring{$\ast$}{*}msg, size\+\_\+t msg\+\_\+len)
\item 
int \mbox{\hyperlink{crypto_8h_abcefe49359b60a5ac8ff77973306d56d}{crypto\+\_\+hkdf\+\_\+sha256}} (const uint8\+\_\+t \texorpdfstring{$\ast$}{*}input, size\+\_\+t input\+\_\+len, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}salt, size\+\_\+t salt\+\_\+len, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}info, size\+\_\+t info\+\_\+len, uint8\+\_\+t \texorpdfstring{$\ast$}{*}output, size\+\_\+t output\+\_\+len)
\begin{DoxyCompactList}\small\item\em HMAC-\/based Key Derivation Function (HKDF). \href{https://tools.ietf.org/html/rfc5869}{\texttt{ https\+://tools.\+ietf.\+org/html/rfc5869}} Derives key material from the input bytes. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{crypto_8h_adef4a9c555eb2fff679128a08a43da7d}{crypto\+\_\+hmac\+\_\+sha256}} (const uint8\+\_\+t \texorpdfstring{$\ast$}{*}key, size\+\_\+t key\+\_\+len, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}input, size\+\_\+t input\+\_\+len, uint8\+\_\+t \texorpdfstring{$\ast$}{*}output)
\begin{DoxyCompactList}\small\item\em Keyed-\/\+Hashing for Message Authentication (HMAC). \href{http://tools.ietf.org/html/rfc2104}{\texttt{ http\+://tools.\+ietf.\+org/html/rfc2104}} Computes HMAC-\/\+SHA-\/256 of the input for the key. The output buffer must be at least SHA256\+\_\+\+OUTPUT\+\_\+\+LENGTH (32) bytes long. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{crypto_8h_abc1ba4ed4300cb5b7dd5dd9bba2491c4}{crypto\+\_\+sha256}} (const uint8\+\_\+t \texorpdfstring{$\ast$}{*}msg, size\+\_\+t msg\+\_\+len, uint8\+\_\+t \texorpdfstring{$\ast$}{*}hash\+\_\+out)
\begin{DoxyCompactList}\small\item\em Secure Hash Algorithms (SHAs) \href{https://www.rfc-editor.org/rfc/rfc6234}{\texttt{ https\+://www.\+rfc-\/editor.\+org/rfc/rfc6234}} Computes HMAC-\/\+SHA-\/256 of the input for the key. The output buffer must be at least SHA256\+\_\+\+OUTPUT\+\_\+\+LENGTH (32) bytes long. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{crypto_8h_a1ecbc7f2cf34bcec4b5d3853bd504bad}{crypto\+\_\+aes\+\_\+encrypt\+\_\+gcm}} (const uint8\+\_\+t \texorpdfstring{$\ast$}{*}plaintext\+\_\+data, size\+\_\+t plaintext\+\_\+data\+\_\+len, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}aes\+\_\+key, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}iv, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}add, size\+\_\+t add\+\_\+len, uint8\+\_\+t \texorpdfstring{$\ast$}{*}ciphertext\+\_\+data)
\begin{DoxyCompactList}\small\item\em AES256 encrypt function in GCM mode. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{crypto_8h_a0abf54c9a3f3c89e4552ea50b87afde3}{crypto\+\_\+aes\+\_\+decrypt\+\_\+gcm}} (const uint8\+\_\+t \texorpdfstring{$\ast$}{*}ciphertext\+\_\+data, size\+\_\+t ciphertext\+\_\+data\+\_\+len, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}aes\+\_\+key, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}iv, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}add, size\+\_\+t add\+\_\+len, uint8\+\_\+t \texorpdfstring{$\ast$}{*}plaintext\+\_\+data, size\+\_\+t \texorpdfstring{$\ast$}{*}plaintext\+\_\+data\+\_\+len)
\begin{DoxyCompactList}\small\item\em AES256 decrypt function in GCM mode. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{crypto_8h_ad449cbcd6449c8cff0b8de22bcc9baa0}{aes256\+\_\+gcm\+\_\+ciphertext\+\_\+data\+\_\+len}} (size\+\_\+t plaintext\+\_\+data\+\_\+length)
\begin{DoxyCompactList}\small\item\em Calculate ciphertext data len for AES GCM. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{crypto_8h_a0c9d322f09b8b9e997838fee395a09a6}{aes256\+\_\+gcm\+\_\+plaintext\+\_\+data\+\_\+len}} (size\+\_\+t ciphertext\+\_\+data\+\_\+len)
\begin{DoxyCompactList}\small\item\em Calculate plaintext data len for AES GCM. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{crypto_8h_afc26d7ca538bd3f7fec38b2c1959beb0}{encrypt\+\_\+aes\+\_\+data\+\_\+with\+\_\+iv}} (const uint8\+\_\+t \texorpdfstring{$\ast$}{*}plaintext\+\_\+data, size\+\_\+t plaintext\+\_\+data\+\_\+len, const uint8\+\_\+t aes\+\_\+key\mbox{[}\mbox{\hyperlink{crypto_8h_af36200aa1d4d85292b027b6d811263ad}{AES256\+\_\+\+KEY\+\_\+\+LENGTH}}\mbox{]}, const uint8\+\_\+t iv\mbox{[}\mbox{\hyperlink{crypto_8h_adbbbf1c1be8a7fb625cf3879c3168dc3}{AES256\+\_\+\+DATA\+\_\+\+IV\+\_\+\+LENGTH}}\mbox{]}, uint8\+\_\+t \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}ciphertext\+\_\+data)
\begin{DoxyCompactList}\small\item\em AES256 encrypt data in GCM mode. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{crypto_8h_a9239e4f32141c64f2ed409902253db2e}{encrypt\+\_\+aes\+\_\+data}} (const uint8\+\_\+t \texorpdfstring{$\ast$}{*}plaintext\+\_\+data, size\+\_\+t plaintext\+\_\+data\+\_\+len, const uint8\+\_\+t aes\+\_\+key\mbox{[}\mbox{\hyperlink{crypto_8h_af36200aa1d4d85292b027b6d811263ad}{AES256\+\_\+\+KEY\+\_\+\+LENGTH}}\mbox{]}, uint8\+\_\+t \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}ciphertext\+\_\+data)
\begin{DoxyCompactList}\small\item\em AES256 encrypt data in GCM mode. The initial vector iv is designated to zeros. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{crypto_8h_a831ecc64b494384eeef10f02f0c5432c}{decrypt\+\_\+aes\+\_\+data\+\_\+with\+\_\+iv}} (const uint8\+\_\+t \texorpdfstring{$\ast$}{*}ciphertext\+\_\+data, size\+\_\+t ciphertext\+\_\+data\+\_\+len, const uint8\+\_\+t aes\+\_\+key\mbox{[}\mbox{\hyperlink{crypto_8h_af36200aa1d4d85292b027b6d811263ad}{AES256\+\_\+\+KEY\+\_\+\+LENGTH}}\mbox{]}, const uint8\+\_\+t iv\mbox{[}\mbox{\hyperlink{crypto_8h_adbbbf1c1be8a7fb625cf3879c3168dc3}{AES256\+\_\+\+DATA\+\_\+\+IV\+\_\+\+LENGTH}}\mbox{]}, uint8\+\_\+t \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}plaintext\+\_\+data)
\begin{DoxyCompactList}\small\item\em AES256 decrypt data in GCM mode. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{crypto_8h_a272ff8f6ce4ccfeb3fe4b94858d16ac7}{decrypt\+\_\+aes\+\_\+data}} (const uint8\+\_\+t \texorpdfstring{$\ast$}{*}ciphertext\+\_\+data, size\+\_\+t ciphertext\+\_\+data\+\_\+len, const uint8\+\_\+t aes\+\_\+key\mbox{[}\mbox{\hyperlink{crypto_8h_af36200aa1d4d85292b027b6d811263ad}{AES256\+\_\+\+KEY\+\_\+\+LENGTH}}\mbox{]}, uint8\+\_\+t \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}plaintext\+\_\+data)
\begin{DoxyCompactList}\small\item\em AES256 decrypt data in GCM mode. The initial vector iv is designated to zeros. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{crypto_8h_aa06fbcdf5dc0b8f1c2bb4ad5eb70a6b9}{encrypt\+\_\+aes\+\_\+file}} (const char \texorpdfstring{$\ast$}{*}in\+\_\+file\+\_\+path, const char \texorpdfstring{$\ast$}{*}out\+\_\+file\+\_\+path, const uint8\+\_\+t aes\+\_\+key\mbox{[}\mbox{\hyperlink{crypto_8h_af36200aa1d4d85292b027b6d811263ad}{AES256\+\_\+\+KEY\+\_\+\+LENGTH}}\mbox{]})
\begin{DoxyCompactList}\small\item\em AES256 encrypt file in GCM mode. The initial vector iv is designated to zeros. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{crypto_8h_afc58ceff0d85193ef70700f828959123}{decrypt\+\_\+aes\+\_\+file}} (const char \texorpdfstring{$\ast$}{*}in\+\_\+file\+\_\+path, const char \texorpdfstring{$\ast$}{*}out\+\_\+file\+\_\+path, const uint8\+\_\+t aes\+\_\+key\mbox{[}\mbox{\hyperlink{crypto_8h_af36200aa1d4d85292b027b6d811263ad}{AES256\+\_\+\+KEY\+\_\+\+LENGTH}}\mbox{]})
\begin{DoxyCompactList}\small\item\em AES256 decrypt file in GCM mode. The initial vector iv is designated to zeros. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{crypto_8h_a450cb7660c7518fa1387b4e73696b464}{encrypt\+\_\+file}} (const char \texorpdfstring{$\ast$}{*}in\+\_\+file\+\_\+path, const char \texorpdfstring{$\ast$}{*}out\+\_\+file\+\_\+path, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}password, const size\+\_\+t password\+\_\+len)
\begin{DoxyCompactList}\small\item\em AES256 encrypt file in GCM mode. The initial vector iv is designated to zeros. The password is an arbitrary vector with non-\/zero length. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{crypto_8h_ac7b60f90ce2bf7b0f3ac50a837ad043a}{decrypt\+\_\+file}} (const char \texorpdfstring{$\ast$}{*}in\+\_\+file\+\_\+path, const char \texorpdfstring{$\ast$}{*}out\+\_\+file\+\_\+path, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}password, const size\+\_\+t password\+\_\+len)
\begin{DoxyCompactList}\small\item\em AES256 decrypt file in GCM mode. The initial vector iv is designated to zeros. The password is an arbitrary vector with non-\/zero length. \end{DoxyCompactList}\item 
char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{crypto_8h_a5fbde9fbb7fd0c6ffc949e1384b84906}{crypto\+\_\+base64\+\_\+encode}} (const uint8\+\_\+t \texorpdfstring{$\ast$}{*}msg, size\+\_\+t msg\+\_\+len)
\begin{DoxyCompactList}\small\item\em Encode to base64 string. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{crypto_8h_a4f5e0daca1f3aca72b3e6e0c35a18de6}{crypto\+\_\+base64\+\_\+decode}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}msg\+\_\+out, const unsigned char \texorpdfstring{$\ast$}{*}base64\+\_\+str)
\begin{DoxyCompactList}\small\item\em Decode from base64 string. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{crypto_8h_a79bd3406be3772ecc1eb6191e49faf65}{crypto\+\_\+hash\+\_\+by\+\_\+e2ees\+\_\+pack\+\_\+id}} (uint32\+\_\+t e2ees\+\_\+pack\+\_\+id\+\_\+raw, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}msg, size\+\_\+t msg\+\_\+len, uint8\+\_\+t \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}hash\+\_\+out, size\+\_\+t \texorpdfstring{$\ast$}{*}hash\+\_\+out\+\_\+len)
\begin{DoxyCompactList}\small\item\em Calculate hash with respect to the specific e2ee pack ID raw number. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{crypto_8h_a8345083dac081465341bff062a51aa9c}{crypto\+\_\+ds\+\_\+key\+\_\+gen\+\_\+by\+\_\+e2ees\+\_\+pack\+\_\+id}} (uint32\+\_\+t e2ees\+\_\+pack\+\_\+id\+\_\+raw, Protobuf\+CBinary\+Data \texorpdfstring{$\ast$}{*}pub\+\_\+key, Protobuf\+CBinary\+Data \texorpdfstring{$\ast$}{*}priv\+\_\+key)
\begin{DoxyCompactList}\small\item\em Generate a random key pair that will be used to generate or verify a signature with respect to the specific e2ee pack ID raw number. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{crypto_8h_a07c3e7cb3179f803c2f5447353fb09aa}{crypto\+\_\+ds\+\_\+sign\+\_\+by\+\_\+e2ees\+\_\+pack\+\_\+id}} (uint32\+\_\+t e2ees\+\_\+pack\+\_\+id\+\_\+raw, uint8\+\_\+t \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}signature\+\_\+out, size\+\_\+t \texorpdfstring{$\ast$}{*}signature\+\_\+out\+\_\+len, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}msg, size\+\_\+t msg\+\_\+len, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}private\+\_\+key, size\+\_\+t private\+\_\+key\+\_\+len)
\begin{DoxyCompactList}\small\item\em Sign a message with respect to the specific e2ee pack ID raw number. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{crypto_8h_a7c2d6f9fac817fe5f7451cf5dd84dea7}{crypto\+\_\+ds\+\_\+verify\+\_\+by\+\_\+e2ees\+\_\+pack\+\_\+id}} (uint32\+\_\+t e2ees\+\_\+pack\+\_\+id\+\_\+raw, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}signature\+\_\+in, size\+\_\+t signature\+\_\+in\+\_\+len, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}msg, size\+\_\+t msg\+\_\+len, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}public\+\_\+key, size\+\_\+t public\+\_\+key\+\_\+len)
\begin{DoxyCompactList}\small\item\em Verify a signature with a given message with respect to the specific e2ee pack ID raw number. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Copyright © 2021 Academia Sinica. All Rights Reserved.

This file is part of E2\+EE Security.

This program is free software\+: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.

E2\+EE Security is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with E2\+EE Security. If not, see \href{http://www.gnu.org/licenses/}{\texttt{ http\+://www.\+gnu.\+org/licenses/}}. 

\doxysubsection{Macro Definition Documentation}
\Hypertarget{crypto_8h_adbbbf1c1be8a7fb625cf3879c3168dc3}\index{crypto.h@{crypto.h}!AES256\_DATA\_IV\_LENGTH@{AES256\_DATA\_IV\_LENGTH}}
\index{AES256\_DATA\_IV\_LENGTH@{AES256\_DATA\_IV\_LENGTH}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{AES256\_DATA\_IV\_LENGTH}{AES256\_DATA\_IV\_LENGTH}}
{\footnotesize\ttfamily \label{crypto_8h_adbbbf1c1be8a7fb625cf3879c3168dc3} 
\#define AES256\+\_\+\+DATA\+\_\+\+IV\+\_\+\+LENGTH~12}

length of an aes256 initialisation vector for file encryption \Hypertarget{crypto_8h_a8c63fc2cbdf1811a42513c959ca5b15a}\index{crypto.h@{crypto.h}!AES256\_GCM\_TAG\_LENGTH@{AES256\_GCM\_TAG\_LENGTH}}
\index{AES256\_GCM\_TAG\_LENGTH@{AES256\_GCM\_TAG\_LENGTH}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{AES256\_GCM\_TAG\_LENGTH}{AES256\_GCM\_TAG\_LENGTH}}
{\footnotesize\ttfamily \label{crypto_8h_a8c63fc2cbdf1811a42513c959ca5b15a} 
\#define AES256\+\_\+\+GCM\+\_\+\+TAG\+\_\+\+LENGTH~16}

length of an aes256 gcm tag \Hypertarget{crypto_8h_a1395a9ebbdaeedb00807f52f8cf9381a}\index{crypto.h@{crypto.h}!AES256\_IV\_LENGTH@{AES256\_IV\_LENGTH}}
\index{AES256\_IV\_LENGTH@{AES256\_IV\_LENGTH}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{AES256\_IV\_LENGTH}{AES256\_IV\_LENGTH}}
{\footnotesize\ttfamily \label{crypto_8h_a1395a9ebbdaeedb00807f52f8cf9381a} 
\#define AES256\+\_\+\+IV\+\_\+\+LENGTH~16}

length of an aes256 initialisation vector \Hypertarget{crypto_8h_af36200aa1d4d85292b027b6d811263ad}\index{crypto.h@{crypto.h}!AES256\_KEY\_LENGTH@{AES256\_KEY\_LENGTH}}
\index{AES256\_KEY\_LENGTH@{AES256\_KEY\_LENGTH}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{AES256\_KEY\_LENGTH}{AES256\_KEY\_LENGTH}}
{\footnotesize\ttfamily \label{crypto_8h_af36200aa1d4d85292b027b6d811263ad} 
\#define AES256\+\_\+\+KEY\+\_\+\+LENGTH~32}

length of an aes256 key \Hypertarget{crypto_8h_af267d8aed138e3cdf5cc4b635ab6fd12}\index{crypto.h@{crypto.h}!CURVE25519\_KEY\_LENGTH@{CURVE25519\_KEY\_LENGTH}}
\index{CURVE25519\_KEY\_LENGTH@{CURVE25519\_KEY\_LENGTH}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{CURVE25519\_KEY\_LENGTH}{CURVE25519\_KEY\_LENGTH}}
{\footnotesize\ttfamily \label{crypto_8h_af267d8aed138e3cdf5cc4b635ab6fd12} 
\#define CURVE25519\+\_\+\+KEY\+\_\+\+LENGTH~32}

length of a public or private Curve25519 key \Hypertarget{crypto_8h_a8a2b042788dd7df27281676080f9d6cc}\index{crypto.h@{crypto.h}!CURVE25519\_RANDOM\_LENGTH@{CURVE25519\_RANDOM\_LENGTH}}
\index{CURVE25519\_RANDOM\_LENGTH@{CURVE25519\_RANDOM\_LENGTH}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{CURVE25519\_RANDOM\_LENGTH}{CURVE25519\_RANDOM\_LENGTH}}
{\footnotesize\ttfamily \label{crypto_8h_a8a2b042788dd7df27281676080f9d6cc} 
\#define CURVE25519\+\_\+\+RANDOM\+\_\+\+LENGTH~\mbox{\hyperlink{cipher__ecc_8h_af267d8aed138e3cdf5cc4b635ab6fd12}{CURVE25519\+\_\+\+KEY\+\_\+\+LENGTH}}}

amount of random data required to create a Curve25519 keypair \Hypertarget{crypto_8h_a5a2bb125ad5cf2351de9cb070d78bcc6}\index{crypto.h@{crypto.h}!CURVE\_SIGNATURE\_LENGTH@{CURVE\_SIGNATURE\_LENGTH}}
\index{CURVE\_SIGNATURE\_LENGTH@{CURVE\_SIGNATURE\_LENGTH}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{CURVE\_SIGNATURE\_LENGTH}{CURVE\_SIGNATURE\_LENGTH}}
{\footnotesize\ttfamily \label{crypto_8h_a5a2bb125ad5cf2351de9cb070d78bcc6} 
\#define CURVE\+\_\+\+SIGNATURE\+\_\+\+LENGTH~64}

length of a Curve25519 signature \Hypertarget{crypto_8h_a06a923f056ee99cb8562286c8fcffc82}\index{crypto.h@{crypto.h}!FILE\_ENCRYPTION\_BUFFER\_LENGTH@{FILE\_ENCRYPTION\_BUFFER\_LENGTH}}
\index{FILE\_ENCRYPTION\_BUFFER\_LENGTH@{FILE\_ENCRYPTION\_BUFFER\_LENGTH}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{FILE\_ENCRYPTION\_BUFFER\_LENGTH}{FILE\_ENCRYPTION\_BUFFER\_LENGTH}}
{\footnotesize\ttfamily \label{crypto_8h_a06a923f056ee99cb8562286c8fcffc82} 
\#define FILE\+\_\+\+ENCRYPTION\+\_\+\+BUFFER\+\_\+\+LENGTH~8192}

buffer length for file encryption/decryption \Hypertarget{crypto_8h_ab1bd3ef9b594e851769e8d7baf17f0f1}\index{crypto.h@{crypto.h}!SHA256\_OUTPUT\_LENGTH@{SHA256\_OUTPUT\_LENGTH}}
\index{SHA256\_OUTPUT\_LENGTH@{SHA256\_OUTPUT\_LENGTH}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{SHA256\_OUTPUT\_LENGTH}{SHA256\_OUTPUT\_LENGTH}}
{\footnotesize\ttfamily \label{crypto_8h_ab1bd3ef9b594e851769e8d7baf17f0f1} 
\#define SHA256\+\_\+\+OUTPUT\+\_\+\+LENGTH~32}

length of a sha256 hash 

\doxysubsection{Function Documentation}
\Hypertarget{crypto_8h_ad449cbcd6449c8cff0b8de22bcc9baa0}\index{crypto.h@{crypto.h}!aes256\_gcm\_ciphertext\_data\_len@{aes256\_gcm\_ciphertext\_data\_len}}
\index{aes256\_gcm\_ciphertext\_data\_len@{aes256\_gcm\_ciphertext\_data\_len}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{aes256\_gcm\_ciphertext\_data\_len()}{aes256\_gcm\_ciphertext\_data\_len()}}
{\footnotesize\ttfamily \label{crypto_8h_ad449cbcd6449c8cff0b8de22bcc9baa0} 
size\+\_\+t aes256\+\_\+gcm\+\_\+ciphertext\+\_\+data\+\_\+len (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{plaintext\+\_\+data\+\_\+length}{}\end{DoxyParamCaption})}



Calculate ciphertext data len for AES GCM. 


\begin{DoxyParams}{Parameters}
{\em plaintext\+\_\+data\+\_\+length} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
size\+\_\+t length of ciphertext data 
\end{DoxyReturn}
\Hypertarget{crypto_8h_a0c9d322f09b8b9e997838fee395a09a6}\index{crypto.h@{crypto.h}!aes256\_gcm\_plaintext\_data\_len@{aes256\_gcm\_plaintext\_data\_len}}
\index{aes256\_gcm\_plaintext\_data\_len@{aes256\_gcm\_plaintext\_data\_len}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{aes256\_gcm\_plaintext\_data\_len()}{aes256\_gcm\_plaintext\_data\_len()}}
{\footnotesize\ttfamily \label{crypto_8h_a0c9d322f09b8b9e997838fee395a09a6} 
size\+\_\+t aes256\+\_\+gcm\+\_\+plaintext\+\_\+data\+\_\+len (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{ciphertext\+\_\+data\+\_\+len}{}\end{DoxyParamCaption})}



Calculate plaintext data len for AES GCM. 


\begin{DoxyParams}{Parameters}
{\em ciphertext\+\_\+data\+\_\+len} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
size\+\_\+t length of plaintext data 
\end{DoxyReturn}
\Hypertarget{crypto_8h_a0abf54c9a3f3c89e4552ea50b87afde3}\index{crypto.h@{crypto.h}!crypto\_aes\_decrypt\_gcm@{crypto\_aes\_decrypt\_gcm}}
\index{crypto\_aes\_decrypt\_gcm@{crypto\_aes\_decrypt\_gcm}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{crypto\_aes\_decrypt\_gcm()}{crypto\_aes\_decrypt\_gcm()}}
{\footnotesize\ttfamily \label{crypto_8h_a0abf54c9a3f3c89e4552ea50b87afde3} 
int crypto\+\_\+aes\+\_\+decrypt\+\_\+gcm (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{ciphertext\+\_\+data}{, }\item[{size\+\_\+t}]{ciphertext\+\_\+data\+\_\+len}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{aes\+\_\+key}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{iv}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{add}{, }\item[{size\+\_\+t}]{add\+\_\+len}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{plaintext\+\_\+data}{, }\item[{size\+\_\+t \texorpdfstring{$\ast$}{*}}]{plaintext\+\_\+data\+\_\+len}{}\end{DoxyParamCaption})}



AES256 decrypt function in GCM mode. 

\begin{DoxySeeAlso}{See also}
\href{https://datatracker.ietf.org/doc/html/rfc5288}{\texttt{ AES256 GCM mode}}
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em ciphertext\+\_\+data} & \\
\hline
{\em ciphertext\+\_\+data\+\_\+len} & \\
\hline
{\em aes\+\_\+key} & \\
\hline
{\em iv} & \\
\hline
{\em add} & \\
\hline
{\em add\+\_\+len} & \\
\hline
{\em plaintext\+\_\+data} & \\
\hline
{\em plaintext\+\_\+data\+\_\+len} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
size\+\_\+t plaintext data length 
\end{DoxyReturn}
\Hypertarget{crypto_8h_a1ecbc7f2cf34bcec4b5d3853bd504bad}\index{crypto.h@{crypto.h}!crypto\_aes\_encrypt\_gcm@{crypto\_aes\_encrypt\_gcm}}
\index{crypto\_aes\_encrypt\_gcm@{crypto\_aes\_encrypt\_gcm}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{crypto\_aes\_encrypt\_gcm()}{crypto\_aes\_encrypt\_gcm()}}
{\footnotesize\ttfamily \label{crypto_8h_a1ecbc7f2cf34bcec4b5d3853bd504bad} 
int crypto\+\_\+aes\+\_\+encrypt\+\_\+gcm (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{plaintext\+\_\+data}{, }\item[{size\+\_\+t}]{plaintext\+\_\+data\+\_\+len}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{aes\+\_\+key}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{iv}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{add}{, }\item[{size\+\_\+t}]{add\+\_\+len}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{ciphertext\+\_\+data}{}\end{DoxyParamCaption})}



AES256 encrypt function in GCM mode. 

\begin{DoxySeeAlso}{See also}
\href{https://datatracker.ietf.org/doc/html/rfc5288}{\texttt{ AES256 GCM mode}} 
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em plaintext\+\_\+data} & \\
\hline
{\em plaintext\+\_\+data\+\_\+len} & \\
\hline
{\em aes\+\_\+key} & \\
\hline
{\em iv} & \\
\hline
{\em add} & \\
\hline
{\em add\+\_\+len} & \\
\hline
{\em ciphertext\+\_\+data} & \\
\hline
\end{DoxyParams}
\Hypertarget{crypto_8h_a4f5e0daca1f3aca72b3e6e0c35a18de6}\index{crypto.h@{crypto.h}!crypto\_base64\_decode@{crypto\_base64\_decode}}
\index{crypto\_base64\_decode@{crypto\_base64\_decode}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{crypto\_base64\_decode()}{crypto\_base64\_decode()}}
{\footnotesize\ttfamily \label{crypto_8h_a4f5e0daca1f3aca72b3e6e0c35a18de6} 
size\+\_\+t crypto\+\_\+base64\+\_\+decode (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{msg\+\_\+out}{, }\item[{const unsigned char \texorpdfstring{$\ast$}{*}}]{base64\+\_\+str}{}\end{DoxyParamCaption})}



Decode from base64 string. 


\begin{DoxyParams}{Parameters}
{\em base64\+\_\+data} & \\
\hline
{\em base64\+\_\+data\+\_\+len} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
char\texorpdfstring{$\ast$}{*} 
\end{DoxyReturn}
\Hypertarget{crypto_8h_a5fbde9fbb7fd0c6ffc949e1384b84906}\index{crypto.h@{crypto.h}!crypto\_base64\_encode@{crypto\_base64\_encode}}
\index{crypto\_base64\_encode@{crypto\_base64\_encode}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{crypto\_base64\_encode()}{crypto\_base64\_encode()}}
{\footnotesize\ttfamily \label{crypto_8h_a5fbde9fbb7fd0c6ffc949e1384b84906} 
char \texorpdfstring{$\ast$}{*} crypto\+\_\+base64\+\_\+encode (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{msg}{, }\item[{size\+\_\+t}]{msg\+\_\+len}{}\end{DoxyParamCaption})}



Encode to base64 string. 


\begin{DoxyParams}{Parameters}
{\em msg} & \\
\hline
{\em msg\+\_\+len} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
char\texorpdfstring{$\ast$}{*} 
\end{DoxyReturn}
\Hypertarget{crypto_8h_a8345083dac081465341bff062a51aa9c}\index{crypto.h@{crypto.h}!crypto\_ds\_key\_gen\_by\_e2ees\_pack\_id@{crypto\_ds\_key\_gen\_by\_e2ees\_pack\_id}}
\index{crypto\_ds\_key\_gen\_by\_e2ees\_pack\_id@{crypto\_ds\_key\_gen\_by\_e2ees\_pack\_id}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{crypto\_ds\_key\_gen\_by\_e2ees\_pack\_id()}{crypto\_ds\_key\_gen\_by\_e2ees\_pack\_id()}}
{\footnotesize\ttfamily \label{crypto_8h_a8345083dac081465341bff062a51aa9c} 
int crypto\+\_\+ds\+\_\+key\+\_\+gen\+\_\+by\+\_\+e2ees\+\_\+pack\+\_\+id (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{e2ees\+\_\+pack\+\_\+id\+\_\+raw}{, }\item[{Protobuf\+CBinary\+Data \texorpdfstring{$\ast$}{*}}]{pub\+\_\+key}{, }\item[{Protobuf\+CBinary\+Data \texorpdfstring{$\ast$}{*}}]{priv\+\_\+key}{}\end{DoxyParamCaption})}



Generate a random key pair that will be used to generate or verify a signature with respect to the specific e2ee pack ID raw number. 


\begin{DoxyParams}{Parameters}
{\em e2ees\+\_\+pack\+\_\+id\+\_\+raw} & \\
\hline
{\em pub\+\_\+key} & \\
\hline
{\em priv\+\_\+key} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
value \texorpdfstring{$<$}{<} 0 for error 
\end{DoxyReturn}
\Hypertarget{crypto_8h_a07c3e7cb3179f803c2f5447353fb09aa}\index{crypto.h@{crypto.h}!crypto\_ds\_sign\_by\_e2ees\_pack\_id@{crypto\_ds\_sign\_by\_e2ees\_pack\_id}}
\index{crypto\_ds\_sign\_by\_e2ees\_pack\_id@{crypto\_ds\_sign\_by\_e2ees\_pack\_id}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{crypto\_ds\_sign\_by\_e2ees\_pack\_id()}{crypto\_ds\_sign\_by\_e2ees\_pack\_id()}}
{\footnotesize\ttfamily \label{crypto_8h_a07c3e7cb3179f803c2f5447353fb09aa} 
int crypto\+\_\+ds\+\_\+sign\+\_\+by\+\_\+e2ees\+\_\+pack\+\_\+id (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{e2ees\+\_\+pack\+\_\+id\+\_\+raw}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{signature\+\_\+out}{, }\item[{size\+\_\+t \texorpdfstring{$\ast$}{*}}]{signature\+\_\+out\+\_\+len}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{msg}{, }\item[{size\+\_\+t}]{msg\+\_\+len}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{private\+\_\+key}{, }\item[{size\+\_\+t}]{private\+\_\+key\+\_\+len}{}\end{DoxyParamCaption})}



Sign a message with respect to the specific e2ee pack ID raw number. 


\begin{DoxyParams}{Parameters}
{\em e2ees\+\_\+pack\+\_\+id\+\_\+raw} & \\
\hline
{\em signature\+\_\+out} & \\
\hline
{\em signature\+\_\+out\+\_\+len} & \\
\hline
{\em msg} & \\
\hline
{\em msg\+\_\+len} & \\
\hline
{\em private\+\_\+key} & \\
\hline
{\em private\+\_\+key\+\_\+len} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
value \texorpdfstring{$<$}{<} 0 for error 
\end{DoxyReturn}
\Hypertarget{crypto_8h_a7c2d6f9fac817fe5f7451cf5dd84dea7}\index{crypto.h@{crypto.h}!crypto\_ds\_verify\_by\_e2ees\_pack\_id@{crypto\_ds\_verify\_by\_e2ees\_pack\_id}}
\index{crypto\_ds\_verify\_by\_e2ees\_pack\_id@{crypto\_ds\_verify\_by\_e2ees\_pack\_id}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{crypto\_ds\_verify\_by\_e2ees\_pack\_id()}{crypto\_ds\_verify\_by\_e2ees\_pack\_id()}}
{\footnotesize\ttfamily \label{crypto_8h_a7c2d6f9fac817fe5f7451cf5dd84dea7} 
int crypto\+\_\+ds\+\_\+verify\+\_\+by\+\_\+e2ees\+\_\+pack\+\_\+id (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{e2ees\+\_\+pack\+\_\+id\+\_\+raw}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{signature\+\_\+in}{, }\item[{size\+\_\+t}]{signature\+\_\+in\+\_\+len}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{msg}{, }\item[{size\+\_\+t}]{msg\+\_\+len}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{public\+\_\+key}{, }\item[{size\+\_\+t}]{public\+\_\+key\+\_\+len}{}\end{DoxyParamCaption})}



Verify a signature with a given message with respect to the specific e2ee pack ID raw number. 


\begin{DoxyParams}{Parameters}
{\em e2ees\+\_\+pack\+\_\+id\+\_\+raw} & \\
\hline
{\em signature\+\_\+in} & \\
\hline
{\em signature\+\_\+in\+\_\+len} & \\
\hline
{\em msg} & \\
\hline
{\em msg\+\_\+len} & \\
\hline
{\em public\+\_\+key} & \\
\hline
{\em public\+\_\+key\+\_\+len} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
value \texorpdfstring{$<$}{<} 0 for error 
\end{DoxyReturn}
\Hypertarget{crypto_8h_a79bd3406be3772ecc1eb6191e49faf65}\index{crypto.h@{crypto.h}!crypto\_hash\_by\_e2ees\_pack\_id@{crypto\_hash\_by\_e2ees\_pack\_id}}
\index{crypto\_hash\_by\_e2ees\_pack\_id@{crypto\_hash\_by\_e2ees\_pack\_id}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{crypto\_hash\_by\_e2ees\_pack\_id()}{crypto\_hash\_by\_e2ees\_pack\_id()}}
{\footnotesize\ttfamily \label{crypto_8h_a79bd3406be3772ecc1eb6191e49faf65} 
int crypto\+\_\+hash\+\_\+by\+\_\+e2ees\+\_\+pack\+\_\+id (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{e2ees\+\_\+pack\+\_\+id\+\_\+raw}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{msg}{, }\item[{size\+\_\+t}]{msg\+\_\+len}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{hash\+\_\+out}{, }\item[{size\+\_\+t \texorpdfstring{$\ast$}{*}}]{hash\+\_\+out\+\_\+len}{}\end{DoxyParamCaption})}



Calculate hash with respect to the specific e2ee pack ID raw number. 


\begin{DoxyParams}{Parameters}
{\em e2ees\+\_\+pack\+\_\+id\+\_\+raw} & \\
\hline
{\em msg} & \\
\hline
{\em msg\+\_\+len} & \\
\hline
{\em hash\+\_\+out} & \\
\hline
{\em hash\+\_\+out\+\_\+len} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
value \texorpdfstring{$<$}{<} 0 for error 
\end{DoxyReturn}
\Hypertarget{crypto_8h_abcefe49359b60a5ac8ff77973306d56d}\index{crypto.h@{crypto.h}!crypto\_hkdf\_sha256@{crypto\_hkdf\_sha256}}
\index{crypto\_hkdf\_sha256@{crypto\_hkdf\_sha256}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{crypto\_hkdf\_sha256()}{crypto\_hkdf\_sha256()}}
{\footnotesize\ttfamily \label{crypto_8h_abcefe49359b60a5ac8ff77973306d56d} 
int crypto\+\_\+hkdf\+\_\+sha256 (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{input}{, }\item[{size\+\_\+t}]{input\+\_\+len}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{salt}{, }\item[{size\+\_\+t}]{salt\+\_\+len}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{info}{, }\item[{size\+\_\+t}]{info\+\_\+len}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{output}{, }\item[{size\+\_\+t}]{output\+\_\+len}{}\end{DoxyParamCaption})}



HMAC-\/based Key Derivation Function (HKDF). \href{https://tools.ietf.org/html/rfc5869}{\texttt{ https\+://tools.\+ietf.\+org/html/rfc5869}} Derives key material from the input bytes. 


\begin{DoxyParams}{Parameters}
{\em input} & \\
\hline
{\em input\+\_\+len} & \\
\hline
{\em salt} & \\
\hline
{\em salt\+\_\+len} & \\
\hline
{\em info} & \\
\hline
{\em info\+\_\+len} & \\
\hline
{\em output} & \\
\hline
{\em output\+\_\+len} & \\
\hline
\end{DoxyParams}
\Hypertarget{crypto_8h_adef4a9c555eb2fff679128a08a43da7d}\index{crypto.h@{crypto.h}!crypto\_hmac\_sha256@{crypto\_hmac\_sha256}}
\index{crypto\_hmac\_sha256@{crypto\_hmac\_sha256}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{crypto\_hmac\_sha256()}{crypto\_hmac\_sha256()}}
{\footnotesize\ttfamily \label{crypto_8h_adef4a9c555eb2fff679128a08a43da7d} 
int crypto\+\_\+hmac\+\_\+sha256 (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{key}{, }\item[{size\+\_\+t}]{key\+\_\+len}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{input}{, }\item[{size\+\_\+t}]{input\+\_\+len}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{output}{}\end{DoxyParamCaption})}



Keyed-\/\+Hashing for Message Authentication (HMAC). \href{http://tools.ietf.org/html/rfc2104}{\texttt{ http\+://tools.\+ietf.\+org/html/rfc2104}} Computes HMAC-\/\+SHA-\/256 of the input for the key. The output buffer must be at least SHA256\+\_\+\+OUTPUT\+\_\+\+LENGTH (32) bytes long. 


\begin{DoxyParams}{Parameters}
{\em key} & \\
\hline
{\em key\+\_\+len} & \\
\hline
{\em input} & \\
\hline
{\em input\+\_\+len} & \\
\hline
{\em output} & \\
\hline
\end{DoxyParams}
\Hypertarget{crypto_8h_abc1ba4ed4300cb5b7dd5dd9bba2491c4}\index{crypto.h@{crypto.h}!crypto\_sha256@{crypto\_sha256}}
\index{crypto\_sha256@{crypto\_sha256}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{crypto\_sha256()}{crypto\_sha256()}}
{\footnotesize\ttfamily \label{crypto_8h_abc1ba4ed4300cb5b7dd5dd9bba2491c4} 
int crypto\+\_\+sha256 (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{msg}{, }\item[{size\+\_\+t}]{msg\+\_\+len}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{hash\+\_\+out}{}\end{DoxyParamCaption})}



Secure Hash Algorithms (SHAs) \href{https://www.rfc-editor.org/rfc/rfc6234}{\texttt{ https\+://www.\+rfc-\/editor.\+org/rfc/rfc6234}} Computes HMAC-\/\+SHA-\/256 of the input for the key. The output buffer must be at least SHA256\+\_\+\+OUTPUT\+\_\+\+LENGTH (32) bytes long. 


\begin{DoxyParams}{Parameters}
{\em msg} & \\
\hline
{\em msg\+\_\+len} & \\
\hline
{\em hash\+\_\+out} & \\
\hline
\end{DoxyParams}
\Hypertarget{crypto_8h_a272ff8f6ce4ccfeb3fe4b94858d16ac7}\index{crypto.h@{crypto.h}!decrypt\_aes\_data@{decrypt\_aes\_data}}
\index{decrypt\_aes\_data@{decrypt\_aes\_data}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{decrypt\_aes\_data()}{decrypt\_aes\_data()}}
{\footnotesize\ttfamily \label{crypto_8h_a272ff8f6ce4ccfeb3fe4b94858d16ac7} 
size\+\_\+t decrypt\+\_\+aes\+\_\+data (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{ciphertext\+\_\+data}{, }\item[{size\+\_\+t}]{ciphertext\+\_\+data\+\_\+len}{, }\item[{const uint8\+\_\+t}]{aes\+\_\+key}{\mbox{[}\+AES256\+\_\+\+KEY\+\_\+\+LENGTH\mbox{]}, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{plaintext\+\_\+data}{}\end{DoxyParamCaption})}



AES256 decrypt data in GCM mode. The initial vector iv is designated to zeros. 


\begin{DoxyParams}{Parameters}
{\em ciphertext\+\_\+data} & \\
\hline
{\em ciphertext\+\_\+data\+\_\+len} & \\
\hline
{\em aes\+\_\+key} & \\
\hline
{\em plaintext\+\_\+data} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
size\+\_\+t plaintext data length 
\end{DoxyReturn}
\Hypertarget{crypto_8h_a831ecc64b494384eeef10f02f0c5432c}\index{crypto.h@{crypto.h}!decrypt\_aes\_data\_with\_iv@{decrypt\_aes\_data\_with\_iv}}
\index{decrypt\_aes\_data\_with\_iv@{decrypt\_aes\_data\_with\_iv}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{decrypt\_aes\_data\_with\_iv()}{decrypt\_aes\_data\_with\_iv()}}
{\footnotesize\ttfamily \label{crypto_8h_a831ecc64b494384eeef10f02f0c5432c} 
size\+\_\+t decrypt\+\_\+aes\+\_\+data\+\_\+with\+\_\+iv (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{ciphertext\+\_\+data}{, }\item[{size\+\_\+t}]{ciphertext\+\_\+data\+\_\+len}{, }\item[{const uint8\+\_\+t}]{aes\+\_\+key}{\mbox{[}\+AES256\+\_\+\+KEY\+\_\+\+LENGTH\mbox{]}, }\item[{const uint8\+\_\+t}]{iv}{\mbox{[}\+AES256\+\_\+\+DATA\+\_\+\+IV\+\_\+\+LENGTH\mbox{]}, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{plaintext\+\_\+data}{}\end{DoxyParamCaption})}



AES256 decrypt data in GCM mode. 


\begin{DoxyParams}{Parameters}
{\em ciphertext\+\_\+data} & \\
\hline
{\em ciphertext\+\_\+data\+\_\+len} & \\
\hline
{\em aes\+\_\+key} & \\
\hline
{\em iv} & \\
\hline
{\em plaintext\+\_\+data} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}
\Hypertarget{crypto_8h_afc58ceff0d85193ef70700f828959123}\index{crypto.h@{crypto.h}!decrypt\_aes\_file@{decrypt\_aes\_file}}
\index{decrypt\_aes\_file@{decrypt\_aes\_file}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{decrypt\_aes\_file()}{decrypt\_aes\_file()}}
{\footnotesize\ttfamily \label{crypto_8h_afc58ceff0d85193ef70700f828959123} 
int decrypt\+\_\+aes\+\_\+file (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{in\+\_\+file\+\_\+path}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{out\+\_\+file\+\_\+path}{, }\item[{const uint8\+\_\+t}]{aes\+\_\+key}{\mbox{[}\+AES256\+\_\+\+KEY\+\_\+\+LENGTH\mbox{]}}\end{DoxyParamCaption})}



AES256 decrypt file in GCM mode. The initial vector iv is designated to zeros. 


\begin{DoxyParams}{Parameters}
{\em in\+\_\+file\+\_\+path} & \\
\hline
{\em out\+\_\+file\+\_\+path} & \\
\hline
{\em aes\+\_\+key} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 0 for success 
\end{DoxyReturn}
\Hypertarget{crypto_8h_ac7b60f90ce2bf7b0f3ac50a837ad043a}\index{crypto.h@{crypto.h}!decrypt\_file@{decrypt\_file}}
\index{decrypt\_file@{decrypt\_file}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{decrypt\_file()}{decrypt\_file()}}
{\footnotesize\ttfamily \label{crypto_8h_ac7b60f90ce2bf7b0f3ac50a837ad043a} 
int decrypt\+\_\+file (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{in\+\_\+file\+\_\+path}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{out\+\_\+file\+\_\+path}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{password}{, }\item[{const size\+\_\+t}]{password\+\_\+len}{}\end{DoxyParamCaption})}



AES256 decrypt file in GCM mode. The initial vector iv is designated to zeros. The password is an arbitrary vector with non-\/zero length. 


\begin{DoxyParams}{Parameters}
{\em in\+\_\+file\+\_\+path} & \\
\hline
{\em out\+\_\+file\+\_\+path} & \\
\hline
{\em password} & \\
\hline
{\em password\+\_\+len} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 0 for success 
\end{DoxyReturn}
\Hypertarget{crypto_8h_a9239e4f32141c64f2ed409902253db2e}\index{crypto.h@{crypto.h}!encrypt\_aes\_data@{encrypt\_aes\_data}}
\index{encrypt\_aes\_data@{encrypt\_aes\_data}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{encrypt\_aes\_data()}{encrypt\_aes\_data()}}
{\footnotesize\ttfamily \label{crypto_8h_a9239e4f32141c64f2ed409902253db2e} 
size\+\_\+t encrypt\+\_\+aes\+\_\+data (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{plaintext\+\_\+data}{, }\item[{size\+\_\+t}]{plaintext\+\_\+data\+\_\+len}{, }\item[{const uint8\+\_\+t}]{aes\+\_\+key}{\mbox{[}\+AES256\+\_\+\+KEY\+\_\+\+LENGTH\mbox{]}, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{ciphertext\+\_\+data}{}\end{DoxyParamCaption})}



AES256 encrypt data in GCM mode. The initial vector iv is designated to zeros. 


\begin{DoxyParams}{Parameters}
{\em plaintext\+\_\+data} & \\
\hline
{\em plaintext\+\_\+data\+\_\+len} & \\
\hline
{\em aes\+\_\+key} & \\
\hline
{\em ciphertext\+\_\+data} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
size\+\_\+t ciphertext data length 
\end{DoxyReturn}
\Hypertarget{crypto_8h_afc26d7ca538bd3f7fec38b2c1959beb0}\index{crypto.h@{crypto.h}!encrypt\_aes\_data\_with\_iv@{encrypt\_aes\_data\_with\_iv}}
\index{encrypt\_aes\_data\_with\_iv@{encrypt\_aes\_data\_with\_iv}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{encrypt\_aes\_data\_with\_iv()}{encrypt\_aes\_data\_with\_iv()}}
{\footnotesize\ttfamily \label{crypto_8h_afc26d7ca538bd3f7fec38b2c1959beb0} 
size\+\_\+t encrypt\+\_\+aes\+\_\+data\+\_\+with\+\_\+iv (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{plaintext\+\_\+data}{, }\item[{size\+\_\+t}]{plaintext\+\_\+data\+\_\+len}{, }\item[{const uint8\+\_\+t}]{aes\+\_\+key}{\mbox{[}\+AES256\+\_\+\+KEY\+\_\+\+LENGTH\mbox{]}, }\item[{const uint8\+\_\+t}]{iv}{\mbox{[}\+AES256\+\_\+\+DATA\+\_\+\+IV\+\_\+\+LENGTH\mbox{]}, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{ciphertext\+\_\+data}{}\end{DoxyParamCaption})}



AES256 encrypt data in GCM mode. 


\begin{DoxyParams}{Parameters}
{\em plaintext\+\_\+data} & \\
\hline
{\em plaintext\+\_\+data\+\_\+len} & \\
\hline
{\em aes\+\_\+key} & \\
\hline
{\em iv} & \\
\hline
{\em ciphertext\+\_\+data} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}
\Hypertarget{crypto_8h_aa06fbcdf5dc0b8f1c2bb4ad5eb70a6b9}\index{crypto.h@{crypto.h}!encrypt\_aes\_file@{encrypt\_aes\_file}}
\index{encrypt\_aes\_file@{encrypt\_aes\_file}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{encrypt\_aes\_file()}{encrypt\_aes\_file()}}
{\footnotesize\ttfamily \label{crypto_8h_aa06fbcdf5dc0b8f1c2bb4ad5eb70a6b9} 
int encrypt\+\_\+aes\+\_\+file (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{in\+\_\+file\+\_\+path}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{out\+\_\+file\+\_\+path}{, }\item[{const uint8\+\_\+t}]{aes\+\_\+key}{\mbox{[}\+AES256\+\_\+\+KEY\+\_\+\+LENGTH\mbox{]}}\end{DoxyParamCaption})}



AES256 encrypt file in GCM mode. The initial vector iv is designated to zeros. 


\begin{DoxyParams}{Parameters}
{\em in\+\_\+file\+\_\+path} & \\
\hline
{\em out\+\_\+file\+\_\+path} & \\
\hline
{\em aes\+\_\+key} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 0 for success 
\end{DoxyReturn}
\Hypertarget{crypto_8h_a450cb7660c7518fa1387b4e73696b464}\index{crypto.h@{crypto.h}!encrypt\_file@{encrypt\_file}}
\index{encrypt\_file@{encrypt\_file}!crypto.h@{crypto.h}}
\doxysubsubsection{\texorpdfstring{encrypt\_file()}{encrypt\_file()}}
{\footnotesize\ttfamily \label{crypto_8h_a450cb7660c7518fa1387b4e73696b464} 
int encrypt\+\_\+file (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{in\+\_\+file\+\_\+path}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{out\+\_\+file\+\_\+path}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{password}{, }\item[{const size\+\_\+t}]{password\+\_\+len}{}\end{DoxyParamCaption})}



AES256 encrypt file in GCM mode. The initial vector iv is designated to zeros. The password is an arbitrary vector with non-\/zero length. 


\begin{DoxyParams}{Parameters}
{\em in\+\_\+file\+\_\+path} & \\
\hline
{\em out\+\_\+file\+\_\+path} & \\
\hline
{\em password} & \\
\hline
{\em password\+\_\+len} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 0 for success 
\end{DoxyReturn}
